<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Defunct: Wrapper for file import — jstor_import • jstor</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Defunct: Wrapper for file import — jstor_import" />

<meta property="og:description" content="This function will be removed in the next release. Please use
jst_import() instead." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jstor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/automating-file-import.html">Automating File Import</a>
    </li>
    <li>
      <a href="../articles/known-quirks.html">Known Data Quirks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/analysing-n-grams.html">Case Study - Analysing Ngrams</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tklebel/jstor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108879690-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-108879690-2');
</script>

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Defunct: Wrapper for file import</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/jstor/blob/master/R/deprecated.R'><code>R/deprecated.R</code></a></small>
    <div class="hidden name"><code>jstor_import.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function will be removed in the next release. Please use
<code><a href='jst_import.html'>jst_import()</a></code> instead.</p>
    
    </div>

    <pre class="usage"><span class='fu'>jstor_import</span>(<span class='no'>in_paths</span>, <span class='no'>out_file</span>, <span class='kw'>out_path</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>.f</span>, <span class='kw'>col_names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>n_batches</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>files_per_batch</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"mc.cores"</span>, <span class='fl'>1L</span>), <span class='kw'>show_progress</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>in_paths</th>
      <td><p>A character vector to the <code>xml</code>-files which should be
imported</p></td>
    </tr>
    <tr>
      <th>out_file</th>
      <td><p>Name of files to export to. Each batch gets appended by an
increasing number.</p></td>
    </tr>
    <tr>
      <th>out_path</th>
      <td><p>Path to export files to (combined with filename).</p></td>
    </tr>
    <tr>
      <th>.f</th>
      <td><p>Function to use for import. Can be one of <code>find_article</code>,
<code>find_authors</code>, <code>find_references</code>, <code>find_footnotes</code>, <code>find_book</code> or
<code>find_chapter</code>.</p></td>
    </tr>
    <tr>
      <th>col_names</th>
      <td><p>Should column names be written to file? Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>n_batches</th>
      <td><p>Number of batches, defaults to 1.</p></td>
    </tr>
    <tr>
      <th>files_per_batch</th>
      <td><p>Number of files for each batch. Can be used instead of
n_batches, but not in conjunction.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Number of cores to use for parallel processing.</p></td>
    </tr>
    <tr>
      <th>show_progress</th>
      <td><p>Displays a progress bar for each batch, if the session
is interactive.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Writes <code>.csv</code>-files to disk.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function applies an import function to a list of <code>xml</code>-files
or a .zip-archive in case of <code>jstor_import_zip</code> and saves
the output in batches of <code>.csv</code>-files to disk.</p>
<p>Along the way, we wrap three functions, which make the process of converting
many files easier:</p><ul>
<li><p><code><a href='https://purrr.tidyverse.org/reference/safely.html'>purrr::safely()</a></code></p></li>
<li><p><code><a href='https://www.rdocumentation.org/packages/foreach/topics/foreach'>foreach::foreach()</a></code></p></li>
<li><p><code><a href='https://readr.tidyverse.org/reference/write_delim.html'>readr::write_csv()</a></code></p></li>
</ul>
    <p>When using one of the <code>find_*</code> functions, there should usually be no errors.
To avoid the whole computation to fail in the unlikely event that an error
occurs, we use <code>safely()</code> which let's us
continue the process, and catch the error along the way.</p>
<p>If you have many files to import, you might benefit from executing the
function in parallel. We use
<code>snow::createCluster()</code> to setup a cluster
and
then compute the results via <code>foreach</code> and <code>%dopar%</code>. The type of
cluster is determined by <code>getClusterOption("type")</code>.</p>
<p>After importing all files, they are written to disk with
<code><a href='https://readr.tidyverse.org/reference/write_delim.html'>readr::write_csv()</a></code>.</p>
<p>Since you might run out of memory when importing a large quantity of files,
the files to import are split up into batches. Each batch is being treated
separately, therefore for each batch multiple processes from
<code>snow::createCluster()</code> are
spawned. For this reason, it is not recommended to have very small batches,
as there is an overhead for starting and ending the processes. On the other
hand, the batches should not be too large, to not exceed memory limitations.
A value of 10000 to 20000 for <code>files_per_batch</code> should work fine on most
machines. If the session is interactive and <code>show_progress</code> is <code>TRUE</code>, a
progress bar is displayed for each batch.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='jst_combine_outputs.html'>jst_combine_outputs()</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># read from file list --------</span>
<span class='co'># find all files</span>
<span class='no'>meta_files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list.files'>list.files</a></span>(<span class='kw'>pattern</span> <span class='kw'>=</span> <span class='st'>"xml"</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='no'>T</span>)

<span class='co'># import them via `find_article`</span>
<span class='fu'>jstor_import</span>(<span class='no'>meta_files</span>, <span class='kw'>out_file</span> <span class='kw'>=</span> <span class='st'>"imported_metadata"</span>, <span class='kw'>.f</span> <span class='kw'>=</span> <span class='no'>find_article</span>,
             <span class='kw'>files_per_batch</span> <span class='kw'>=</span> <span class='fl'>25000</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>4</span>)

<span class='co'># read from zip archive ------ </span>
<span class='co'># define imports</span>
<span class='no'>imports</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='jst_define_import.html'>jst_define_import</a></span>(<span class='kw'>article</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='no'>find_article</span>, <span class='no'>find_authors</span>))

<span class='co'># convert the files to .csv</span>
<span class='fu'>jstor_import_zip</span>(<span class='st'>"my_archive.zip"</span>, <span class='kw'>out_file</span> <span class='kw'>=</span> <span class='st'>"my_out_file"</span>,
                 <span class='kw'>import_spec</span> <span class='kw'>=</span> <span class='no'>imports</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://thomasklebel.eu'>Thomas Klebel</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

